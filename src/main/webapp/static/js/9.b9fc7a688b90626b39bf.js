webpackJsonp([9],{192:function(t,e,o){function a(t){o(289)}var i=o(24)(o(222),o(307),a,"data-v-430ef071",null);t.exports=i.exports},222:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{word:"",searchWord:"",orderBy:2,listLoading:!1,exportLoading:!1,tableData:[],addDialog:!1,form:{tittle:"",content:""},currentPage:1,pageSize:20,total:0,tableTop:0,rules:{tittle:[{required:!0,message:"标题不能为空",trigger:"blur"},{max:20,message:"限 20 个字符",trigger:"blur"}],content:[{required:!0,message:"内容不能为空",trigger:"blur"},{max:200,message:"限 200 个字符",trigger:"blur"}]}}},props:["API"],computed:{tableMaxHeight:function(){return this.$store.commit("setTableMaxHeight",this.tableTop),this.$store.state.tableMaxHeight},tittleNum:function(){return this.form.tittle&&this.form.tittle.length||0},contentNum:function(){return this.form.content&&this.form.content.length||0}},methods:{search:function(t){this.word=this.searchWord,this.currentPage=1,this.getList(this.word)},sortTable:function(){this.orderBy=1==this.orderBy?2:1,this.getList(this.word)},formatTime:function(t,e){return this.$common.getNowTime(t.createAt&&t.createAt.time)},addItem:function(){this.form={tittle:"",content:""},this.addDialog=!0},addSave:function(t){var e=this;this.$refs[t].validate(function(t){t&&e.$confirm("是否确认添加?","提示",{}).then(function(){e.addDialog=!1,e.$message("正在添加，请稍等...");var t={head:e.$common.getUserStorage(),body:{content:e.form.content,tittle:e.form.tittle}};e.$common._post("MessageBase/add",t,e,function(t){e.$message({type:"success",message:"添加成功!"}),e.getList()})}).catch(null)})},deleteItem:function(t,e){var o={head:this.$common.getUserStorage(),body:{id:e.id,tittle:e.tittle}};this.$common.deleteItem(this.API+"MessageBase/delete",this,o)},resetFields:function(t){this.$refs[t].resetFields(),this.form={}},exportExc:function(){var t=this;this.exportLoading=!0;var e={head:this.$common.getUserStorage(),body:{}};this.$http.post(this.API+"exportExcelMessageBase",e).then(function(e){t.exportLoading=!1;var e=e.body;"0"==e.body.result?location.href=e.body.fileUrl:t.$message(e.body.description)})},handleCurrentChange:function(t){this.currentPage=t,this.getList(this.word)},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.listLoading=!0;var o={head:this.$common.getUserStorage(),body:{pageIndex:this.currentPage,pageSize:this.pageSize,tittle:e,orderBy:this.orderBy}};this.$common._post("MessageBase/list",o,this,function(e){t.total=e.total,t.tableData=e.list,t.listLoading=!1},function(e){t.listLoading=!1,t.tableData=[]})}},mounted:function(){if(!sessionStorage.getItem("zhizunbao_login"))return this.$message("请登录账号"),void this.$router.push("/");this.getList(),this.tableTop=document.querySelector("#main table").getBoundingClientRect().top}}},271:function(t,e,o){e=t.exports=o(182)(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"system-push.vue",sourceRoot:""}])},289:function(t,e,o){var a=o(271);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o(183)("64c4d4ca",a,!0)},307:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-row",[o("el-col",{staticClass:"search-bar"},[o("el-input",{staticClass:"w_200",attrs:{placeholder:"请输入标题",icon:"search","on-icon-click":t.search},model:{value:t.searchWord,callback:function(e){t.searchWord=e},expression:"searchWord"}}),t._v(" "),o("div",{staticClass:"m_l_20"},[o("el-button",{on:{click:t.sortTable}},[t._v(t._s(1==t.orderBy?"正":"倒")+"序排列")])],1),t._v(" "),o("div",{staticClass:"m_l_20"},[o("el-button",{attrs:{icon:"plus"},on:{click:t.addItem}},[t._v("新建消息")])],1),t._v(" "),o("div",{staticClass:"m_l_20"},[o("el-button",{attrs:{loading:t.exportLoading,icon:"document"},on:{click:t.exportExc}},[t._v("导出Excel")])],1)],1)],1),t._v(" "),o("el-row",[o("el-col",[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"table",attrs:{data:t.tableData,border:"",width:"100%","max-height":t.tableMaxHeight}},[o("el-table-column",{attrs:{align:"center",label:"序号",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(e.$index+1+t.pageSize*(t.currentPage-1))+"\n                    ")]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"center",prop:"tittle",label:"标题"}}),t._v(" "),o("el-table-column",{attrs:{align:"center",prop:"content",label:"内容"}}),t._v(" "),o("el-table-column",{attrs:{align:"center",prop:"createAt.time",label:"注册时间",width:"150",formatter:t.formatTime}}),t._v(" "),o("el-table-column",{attrs:{align:"center",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"small",type:"danger",icon:"delete2"},on:{click:function(o){t.deleteItem(e.$index,e.row)}}},[t._v("删除")])]}}])})],1)],1)],1),t._v(" "),o("el-row",[o("el-col",[o("div",{staticClass:"block pagination"},[o("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:"prev, pager, next, jumper","page-count":t.total},on:{"update:currentPage":function(e){t.currentPage=e},"current-change":t.handleCurrentChange}})],1)])],1),t._v(" "),o("el-dialog",{staticClass:"add add-dialog",attrs:{title:"推送消息",visible:t.addDialog},on:{"update:visible":function(e){t.addDialog=e},close:function(e){t.resetFields("ruleForm")}}},[o("el-form",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules}},[o("el-form-item",{attrs:{label:"标题",prop:"tittle"}},[o("span",[t._v(t._s(t.tittleNum))]),t._v("/20\n                "),o("el-input",{attrs:{type:"text",maxlength:20,placeholder:"请输入标题"},model:{value:t.form.tittle,callback:function(e){t.form.tittle=e},expression:"form.tittle"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"正文：",prop:"content"}},[o("span",[t._v(t._s(t.contentNum))]),t._v("/200\n                "),o("el-input",{attrs:{type:"textarea",maxlength:200,rows:5,placeholder:"请输入内容"},model:{value:t.form.content,callback:function(e){t.form.content=e},expression:"form.content"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",slot:"footer"},[o("el-button",{on:{click:function(e){t.addDialog=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addSave("ruleForm")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=9.b9fc7a688b90626b39bf.js.map